<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-colors-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2024-02-13T09:29:37.478796"><title>Implementing custom Saxon collation URI resolvers | DITA Open Toolkit 4.1</title><script type="application/json" id="virtual-toc-data">[]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.6.6-b205/app.css" rel="stylesheet"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><link rel="manifest" href="site.webmanifest"><meta name="msapplication-TileColor" content="#000000"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Implementing custom Saxon collation URI resolvers | DITA Open Toolkit 4.1"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="DITA Open Toolkit 4.1 Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="implement-saxon-collation-uri-resolvers.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Implementing custom Saxon collation URI resolvers | DITA Open Toolkit 4.1"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "implement-saxon-collation-uri-resolvers.html#webpage",
    "url": "implement-saxon-collation-uri-resolvers.html",
    "name": "Implementing custom Saxon collation URI resolvers | DITA Open Toolkit 4.1",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "/#website",
    "url": "/",
    "name": "DITA Open Toolkit 4.1 Help"
}</script><!-- End Schema.org --></head><body data-id="implement-saxon-collation-uri-resolvers" data-main-title="Implementing custom Saxon collation URI resolvers" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="custom-plugins.md|Creating plug-ins///plugin-use-cases.md|Plug-in use cases///implement-saxon-customizations.md|Adding Saxon customizations"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>DITA Open Toolkit 4.1  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="implement-saxon-collation-uri-resolvers" id="implement-saxon-collation-uri-resolvers.md">Implementing custom Saxon collation URI resolvers</h1><p id="c700b301_2">Plug-ins can provide custom URI resolvers that provide collators for specific collation URIs.</p><p id="c700b301_3">To do custom sorting and grouping in XSLT, you identify collators using URIs that Saxon resolves to collator implementations. You implement the mapping from collation URIs to collators through custom collation URI resolvers.</p><p id="c700b301_4">For example, the DITA Community I18N plugin provides a custom collator for doing dictionary-based sorting and grouping of Simplified Chinese.</p><p id="c700b301_5">To allow multiple plug-ins to contribute collation URI resolvers, DITA-OT defines a superinterface of Saxon&rsquo;s <code class="code" id="c700b301_6">CollationUriResolver</code> interface, <code class="code" id="c700b301_7">org.dita.dost.module.saxon.DelegatingCollationUriResolver</code>, that takes a base resolver.</p><p id="c700b301_8">Implementations of <code class="code" id="c700b301_9">DelegatingCollationUriResolver</code> should delegate to their base resolver if they do not resolve the URI specified on the resolve request. When multiple plug-ins provide resolvers it results in a chain of resolvers, ending with the built-in Saxon default resolver.</p><p id="c700b301_10"><span class="control" id="c700b301_11">Note:</span> The order in which plug-ins will be processed during collation URI resolver configuration is variable, so two plug-ins should not try to resolve the same collation URI. In that case the first one configured will be used at run time.</p><p id="c700b301_12">A typical delegating collation URI resolver looks like this:</p><div class="code-block" data-lang="none">
public class DCI18nCollationUriResolver implements DelegatingCollationUriResolver {

  public static final String DITA_COMMUNITY_I18N_ZH_CNAWARE_COLLATOR =
      &quot;http://org.dita-community.i18n.zhCNawareCollator&quot;;
  public static final String LANG_URI_PARAM = &quot;lang&quot;;

  private CollationURIResolver baseResolver;

  public DCI18nCollationUriResolver() {
      super();
      this.baseResolver = StandardCollationURIResolver.getInstance();
  }


  public net.sf.saxon.lib.StringCollator resolve(String uri, Configuration configuration) 
          throws XPathException {
      ZhCnAwareCollator collator = resolveToZhCnAwareCollator(uri, null, configuration);
      if (null == collator) {
          return baseResolver.resolve(uri, configuration);
      }
      return (StringCollator) collator;
  }


  @Override
  public void setBaseResolver(CollationURIResolver baseResolver) {
    this.baseResolver = baseResolver;
  }
  
  /* ... Code to evaluate the collation URI and provide the appropriate collator goes here */
}
</div><p id="c700b301_14">To implement a custom collation URI resolver:</p><ol class="list _decimal" id="c700b301_15" type="1"><li class="list__item" id="c700b301_16"><p id="c700b301_17">Add your plugin&rsquo;s JAR file in the DITA-OT class path as described in <a href="plugin-javalib.html" id="c700b301_18" data-tooltip="You can use the dita.conductor.lib.import extension point to add an additional Java library to the DITA-OT classpath parameter.">Adding a Java library to the classpath</a>.</p></li><li class="list__item" id="c700b301_19"><p id="c700b301_20">Implement an instance of <code class="code" id="c700b301_21">org.dita.dost.module.saxon.DelegatingCollationUriResolver</code> as described above.</p></li><li class="list__item" id="c700b301_22"><p id="c700b301_23">Include a file named <code class="code" id="c700b301_24">org.dita.dost.module.saxon.DelegatingCollationUriResolver</code> in the directory <code class="code" id="c700b301_25">META-INF/services</code> in the compiled JAR that your plug-in provides. Each line of the file must be the name of a class that implements <code class="code" id="c700b301_26">org.dita.dost.module.saxon.DelegatingCollationUriResolver</code>:</p><div class="code-block" data-lang="none">
org.example.i18n.saxon.MyCollationUriResolver
</div><p id="c700b301_28">You can create the services file using <code class="code" id="c700b301_29">&lt;service&gt;</code> elements in an Ant <code class="code" id="c700b301_30">&lt;jar&gt;</code> task:</p><div class="code-block" data-lang="none">
&lt;jar destfile=&quot;${basedir}/target/lib/example-saxon.jar&quot;&gt;
  [...]
  &lt;service type=&quot;org.dita.dost.module.saxon.DelegatingCollationUriResolver&quot;&gt;
    &lt;provider classname=&quot;org.example.i18n.saxon.MyCollationUriResolver&quot;/&gt;
  &lt;/service&gt;
  [...]
&lt;/jar&gt;
</div></li><li class="list__item" id="c700b301_32"><p id="c700b301_33">To use the collator in XSLT style sheets, specify the collation URI on <code class="code" id="c700b301_34">@xsl:sort</code> elements (or anywhere a collator URI can be specified):</p><div class="code-block" data-lang="none">
&lt;xsl:apply-templates select=&quot;word&quot;&gt;
  &lt;xsl:sort collation=&quot;http://org.example.i18n.MyCollator&quot;/&gt;
&lt;/xsl:apply-templates&gt;
</div></li></ol><p id="c700b301_36"><span class="control" id="c700b301_37">Related information</span></p><p id="c700b301_38"><a href="https://www.oxygenxml.com/events/2015/dita-ot_day.html#DITA_Community" id="c700b301_39" data-external="true" rel="noopener noreferrer">DITA Community</a></p><div class="last-modified">Last modified: 13 February 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="implement-saxon-extension-functions.html" class="navigation-links__prev">Implementing Saxon extension functions</a><a href="html-customization-plugins.html" class="navigation-links__next">Custom HTML plug-ins</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.6.6-b205/app.js"></script></body></html>